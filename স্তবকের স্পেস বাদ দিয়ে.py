import string

def clean_string_lines_advanced(text: str) -> str:
    """
    একটি মাল্টি-লাইন স্ট্রিংকে পরিষ্কার করে।

    আপডেট করা নিয়মাবলী:
    ১. লাইনের মাঝের একাধিক স্পেসকে একটি স্পেসে পরিণত করে।
    ২. লাইনের শেষের ইংরেজি ও বাংলা যতিচিহ্ন (দাঁড়িসহ) মুছে দেয়।
    ৩. লাইনের শুরু এবং শেষের অতিরিক্ত স্পেস মুছে দেয়।
    ৪. প্যারাগ্রাফের মাঝের ফাঁকা লাইনগুলো বাদ দেয়।
    """
    cleaned_lines = []
    
    # পাইথনের সব যতিচিহ্নের সাথে বাংলা দাঁড়ি (।) যোগ করা হলো
    all_punctuation = string.punctuation + '।' + '॥'

    # স্ট্রিংটিকে প্রতিটি লাইনে ভাগ করা হলো
    for line in text.splitlines():
        
        # নিয়ম ৩: লাইনের শুরু এবং শেষের অতিরিক্ত স্পেস মুছে দেওয়া হলো
        stripped_line = line.strip()
        
        # নিয়ম ১: একাধিক স্পেসকে একটিতে পরিণত করা হলো
        words = stripped_line.split()
        normalized_space_line = ' '.join(words)
        
        # নিয়ম ২: লাইনের শেষে থাকা যেকোনো যতিচিহ্ন মুছে দেওয়া হলো
        final_line = normalized_space_line.rstrip(all_punctuation)
        
        # নতুন নিয়ম ৪: যদি লাইনটি পরিষ্কার করার পর খালি না থাকে, তবেই সেটিকে লিস্টে যোগ করা হবে
        # এর ফলে ফাঁকা লাইনগুলো বাদ পড়ে যাবে।
        if final_line:
            cleaned_lines.append(final_line)
    
    # পরিষ্কার করা লাইনগুলোকে আবার নতুন লাইন দিয়ে জুড়ে একটি সম্পূর্ণ স্ট্রিং তৈরি করা হলো
    return '\n'.join(cleaned_lines)

# --- নতুন নিয়ম পরীক্ষার জন্য উদাহরণ ---
sample_text_with_dandi = """
মোরা একটি ফুলকে বাঁচাবো বলে যুদ্ধ করি

মোরা একটি মুখের হাসির জন্য অস্ত্র ধরি


যে মাটির চির মমতা আমার অঙ্গে মাখা

যার নদী জল ফুলে ফুলে মোর স্বপ্ন আঁকা

যে দেশের নীল অম্বরে মন মেলছে পাখা

সারাটি জনম সে মাটির দানে বক্ষ ভরি


মোরা নতুন একটি কবিতা লিখতে যুদ্ধ করি―

মোরা নতুন একটি গানের জন্য যুদ্ধ করি

মোরা একখানা ভালো ছবির জন্য যুদ্ধ করি

মোরা সারা বিশ্বের শান্তি বাঁচাতে আজকে লড়ি


যে নারীর মধু প্রেমেতে আমার রক্ত দোলে

যে শিশুর মায়া হাসিতে আমার বিশ্ব ভোলে

যে গৃহ কপোত সুখ স্বর্গের দুয়ার খোলে

সেই শান্তির শিবির বাঁচাতে শপথ করি
"""

# ফাংশনটি ব্যবহার করে আউটপুট দেখা
cleaned_text = clean_string_lines_advanced(sample_text_with_dandi)

# --- পরীক্ষার জন্য আউটপুট ---
print("------")
# আউটপুট দেখানো
print("--- পরিষ্কার করা টেক্সট ---")

print(cleaned_text)